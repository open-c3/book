# 简介

OPEN-C3为每个服务树节点提供了一个地方存储变量。默认情况下使用流水线时会自动保存发布版本到变量中。

用户可以自己通过脚本调用的方式采集服务器中的内容保存到变量中。【比如：系统版本】

# 查看变量

页面路径:【业务管理】->【查看变量】

变量有如下两个用途：

## 用于记录发布版本

```
在发布作业过程中，执行命令和同步文件这两个插件，如果是在作业的最前和最后步骤，会修改该流程版本的变量。

如当前要发布版本为release-01，
如果第一步为执行脚本或者同步插件，机器的版本会变成Do_release-01 ，意思是正在做这个版本的发布。
如果最后一步为执行脚本或者同步插件，机器的版本会变成release-01.

在默认情况下，系统会以变量中的描述来识别线上服务的版本，如果要发布或者回滚业务时，在某一个分批中，如果发现所有的
机器当前的版本就是现在想要发布的版本，那该发布批次会进行跳过。

如果就是想再发布一次一样的版本，其中一个处理办法是，可以把变量中记录的版本给删除了。
```

![查看变量](/查看变量/images/查看变量.png)

变量大部分情况下在如下地方会用到：
```
流水线会通过获取变量“APP_ci_流水线id_VERSION”做下面的提示。
```
线上当前程序版本比例：
![变量提示版本比例](/查看变量/images/变量提示版本比例.png)

回滚版本提示：
![变量推荐回滚版本](/查看变量/images/变量推荐回滚版本.png)

## 用于采集变量

当运行脚本时，脚本的输出内容有如下格式，系统会自动保存到变量中。

格式正则表达式： ([a-zA-Z][a-zA-Z0-9_]+):\[([a-z0-9\._\-]+)\]

例：

```
如执行脚本： echo 'abc:[123]'

执行结束后，在变量页面，这个机器多出一个变量abc，并且abc的值为123。

```

用途：比如想采集一下机器上运行的nginx的版本，或者业务想采集机器上当前使用的数据版本，就可以配置个定时任务，定时的采集机器上的版本存到OPEN-C3的变量中。